<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>WhatsApp</title>
	</head>
	<body>
		<div align="center">
			<h1>WhatsApp</h1>
			<h2>Envie uma mensagem para o seu próprio número!</h2>
			<label for="ddi" style="width: 100px; text-align: right; display: inline-block;">Seu DDI: </label>
			<input type="text" id="ddi" name="ddi" value="55" onchange="changeLink()" style="width: 30px;" maxlength="2" />
			<span style="width: 86px; text-align: right; display: inline-block;" ></span>
			<br />
			<label for="ddd" style="width: 100px; text-align: right; display: inline-block;">Seu DDD: </label>
			<input type="text" id="ddd" name="ddd" value="21" onchange="changeLink()" style="width: 30px;" maxlength="2" />
			<span style="width: 86px; text-align: right; display: inline-block;" ></span>
			<br />
			<label for="phone" style="width: 100px; text-align: right; display: inline-block;">Seu Telefone: </label>
			<input type="text" id="phone" name="phone" value="" onchange="changeLink()" style="width: 120px;" maxlength="11" />
			<br />
			<a id="link" name="link" target="WhatsApp">Enviar Mensagem</a>
			<h3>Projeto desenvolvido por <a href="https://github.com/Bruno-N-Fernandes">Bruno-N-Fernandes</a></h3>
			<h4>Projeto hospedado no <a href="https://github.com/Bruno-N-Fernandes/MPSC.PlenoSoft.WhatsApp">Git Hub</a></h4>
		</div>
		<script type="text/javascript">
			const mensagem = "https://bruno-n-fernandes.github.io/MPSC.PlenoSoft.WhatsApp/";
			const txtddi = document.getElementById("ddi");
			const txtddd = document.getElementById("ddd");
			const txtphone = document.getElementById("phone");
			const link = document.getElementById("link");

			const insert = function insert(main_string, ins_string, pos) {
				if(typeof(pos) == "undefined") {
					pos = 0;
				}
				if(typeof(ins_string) == "undefined") {
					ins_string = '';
				}
				return main_string.slice(0, pos) + ins_string + main_string.slice(pos);
			}
			
			function changeLink() {
				let ddi = txtddi.value.trim();
				let ddd = txtddd.value.trim();
				let number = txtphone.value.replace(" ", "").replace("-", "");
				let phone = insert(insert(number, "-", 5), " ", 1);
				let fullPhone = `+${ddi} (${ddd}) ${phone}`;
				let fullNumber = ddi + ddd + number;
				
				link.href = `https://api.whatsapp.com/send?phone=${fullNumber}&text=${mensagem}`;
				link.text = `Enviar Mensagem para ${fullPhone}`;
			}
			
			changeLink();
		</script>
	</body>
</html>
